{
  "hash": "7436263d32087f3af5a4410f707cbf9b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"more EDA on Other Datasets\"\ndescription:  |\n  More EDA on other datasets\nauthor: \"\"\ndate: \"2024-11-18\"\ndate-modified: \"2024-11-18\"\ndraft: FALSE\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(tidyverse))\nsuppressPackageStartupMessages(library(sf))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'sf' was built under R version 4.4.2\n```\n\n\n:::\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(dplyr))\nsuppressPackageStartupMessages(library(viridis))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'viridis' was built under R version 4.4.2\n```\n\n\n:::\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(maps))\n```\n:::\n\n\n\nThis week, we picked one dataset from the two other dataset we found last week. We've picked the firearm suicide dataset. This dataset describes the number of homicides, the number of suicides, and the number of suicides done with firearms for whites & nonwhites within different states from 1949 to 2020. We picked this dataset since it is easier to combine by locations.\n\nDataset:[Firearm Suicide Proxy for Household Gun Ownership](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/QVYDUD)\n\nFirst of all, we did some EDA on the second dataset. This map represents the rate of homicides by firearm  by state. We were having some issues working with the mapping functions, which we have to fix. As the map borders do not currently line up with the data coordinates which is causing the coloring to be misaligned with the borders, but we are still working through solving this issue.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfirearm_data <- read_rds(\"dataset/firearm_sh_ds.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfirearm_data <- firearm_data |>\n  mutate(firearm_homicide_rate = as.numeric(firearm_homicide_rate),\n         state = tolower(state)) |>\n  filter(!is.na(firearm_homicide_rate))\n\nus_states <- map_data(\"state\") |>\n  as_tibble() |>\n  st_as_sf(coords = c(\"long\", \"lat\"), crs = 4326) |>\n  group_by(region) |>\n  summarise(geometry = st_union(geometry)) |>\n  st_transform(crs = 5070)\n\nus_states <- us_states |>\n  st_cast(\"POLYGON\")\n\nmap_data <- us_states |>\n  rename(state = region) |>\n  left_join(firearm_data, by = \"state\")\n\nmap_data$log_firearm_homicide_rate <- log(map_data$firearm_homicide_rate + 1)\n\nggplot(map_data) +\n  geom_sf(aes(fill = log_firearm_homicide_rate), color = \"black\", size = 0.2) +\n  scale_fill_viridis_c(option = \"plasma\", name = \"Homicide Rate\") +\n  theme_minimal() +\n  labs(\n    title = \"Firearm Homicide Rate by State\",\n    fill = \"Rate\"\n  ) +\n  facet_wrap(~year)\n```\n\n::: {.cell-output-display}\n![](More-EDA_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThen, we started to combine the two datasets. We decided to combine based on locations. The first dataset was divided into four regions: Northeast, Midwest, South, and West while the second dataset was divided into different states. We planned to categorize the the states in the second dataset into regions just like the first dataset.\n\nIn combining the dataset we decided to do so by grouping data from both datasets by region and year. Our original dataset used regions instead of states, so by converting from states to region we used the regional definitions used by the [Census Bureau Designated Regions](https://en.wikipedia.org/wiki/List_of_regions_of_the_United_States).\nFor each region and year we summarized the data into categories that include proportional data for certain types of incidents related to police contact, racial distributions, homicide rate, etc.\n\nThe combination of the data is done using the code in \"/scripts/load_and_clean_data.R\". Below is a table, which displays each new column and its description. Followed by the new combined data itself.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariable_table <- tibble(\n  Variable_Name = c(\"region\", \"year\", \"total_count\", \"WHITE_NH_PROP\", \"B_NH_PROP\", \"HISPANIC_PROP\", \"OTHER_MULTI_NH_PROP\", \"CONTACT_FREQ\", \"OC_FRISK_PROP\", \"TC_FRISK_PROP\", \"VSRCH_PROP\", \"ARREST_PROP\", \"CUFFED_PROP\", \"PROPER_PROP\", \"IMPROPER_PROP\", \"AVG_CONT\", \"population\", \"fa_homicides\", \"nfa_homicides\", \"homicides\", \"fa_homicide_rate\", \"nfa_homicide_rate\", \"homicide_rate\"),\n  Variable_Description = c(\"Region the data is from\", \"Year the data is from\", \"Total number of responses in the police sentiment dataset\", \"White non-hispanic proportion of responses for police sentiment\", \"Black non-hispanic proportion of responses for police sentiment\", \"Hispanic proportion of responses for police sentiment survey\", \"Other/multiracial/Non-hispanic proportion of responses for police sentiment survey\", \"Proportion of responders who had contact with law enforcement\", \"Proportion of stop and frisks for non-traffic stops\", \"Proportion of stop and frisks for traffic stops\", \"Proportion of vehicle searchs\", \"Proportions of contacts that ended in arrest\", \"Proportion of contacts that included cuffing\", \"Proportion of contacts deemed handled proper\", \"Proportion of contacts deemed unproperly handled\", \"Average number of contacts in the last year\", \"Total region population from US census\", \"Number of Firearm homicides\", \"Number of non-firearm homicides\", \"number of homidides\", \"firearm homicides per 100,000\", \"non-firearm homicides per 100,000\", \"homicides per 100,000\")\n)\n\nprint(variable_table, n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 23 × 2\n   Variable_Name       Variable_Description                                     \n   <chr>               <chr>                                                    \n 1 region              Region the data is from                                  \n 2 year                Year the data is from                                    \n 3 total_count         Total number of responses in the police sentiment dataset\n 4 WHITE_NH_PROP       White non-hispanic proportion of responses for police se…\n 5 B_NH_PROP           Black non-hispanic proportion of responses for police se…\n 6 HISPANIC_PROP       Hispanic proportion of responses for police sentiment su…\n 7 OTHER_MULTI_NH_PROP Other/multiracial/Non-hispanic proportion of responses f…\n 8 CONTACT_FREQ        Proportion of responders who had contact with law enforc…\n 9 OC_FRISK_PROP       Proportion of stop and frisks for non-traffic stops      \n10 TC_FRISK_PROP       Proportion of stop and frisks for traffic stops          \n11 VSRCH_PROP          Proportion of vehicle searchs                            \n12 ARREST_PROP         Proportions of contacts that ended in arrest             \n13 CUFFED_PROP         Proportion of contacts that included cuffing             \n14 PROPER_PROP         Proportion of contacts deemed handled proper             \n15 IMPROPER_PROP       Proportion of contacts deemed unproperly handled         \n16 AVG_CONT            Average number of contacts in the last year              \n17 population          Total region population from US census                   \n18 fa_homicides        Number of Firearm homicides                              \n19 nfa_homicides       Number of non-firearm homicides                          \n20 homicides           number of homidides                                      \n21 fa_homicide_rate    firearm homicides per 100,000                            \n22 nfa_homicide_rate   non-firearm homicides per 100,000                        \n23 homicide_rate       homicides per 100,000                                    \n```\n\n\n:::\n:::\n",
    "supporting": [
      "More-EDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}